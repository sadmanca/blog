<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UofT PEY Co-op Jobs (2024-2025 Fall/Winter)</title>
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simplebar@latest/dist/simplebar.css">
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
   <script src="https://cdn.jsdelivr.net/npm/simplebar@latest/dist/simplebar.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise/dist/ag-grid-enterprise.min.js"></script>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

  <!-- Preconnect to the font file origin -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

  <!-- Preload the Inter Tight font CSS -->
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" />

  <!-- Asynchronously load the Inter Tight font CSS -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" media="print" onload="this.media='all'" />

  <!-- Fallback: Load the Inter Tight font CSS synchronously if JavaScript is disabled -->
  <noscript>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" />
  </noscript>

  <!-- Preload the Inter font CSS (if you need both variants of the Inter font) -->
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" />

  <!-- Asynchronously load the Inter font CSS -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" media="print" onload="this.media='all'" />

  <!-- Fallback: Load the Inter font CSS synchronously if JavaScript is disabled -->
  <noscript>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" />
  </noscript>

  <style>
    .ag-header-cell-label {
      white-space: normal; /* Allow text to wrap */
      overflow: hidden; /* Hide overflow text */
      text-overflow: ellipsis; /* Add ellipsis for overflow text */
      max-height: 3em; /* Limit header height to approximately 2 lines */
    }
  </style>

   <style>
    .cell-wrap-text {
      white-space: normal !important;
    }

    .ag-theme-quartz .ag-cell-value {
      line-height: 15px !important;
      word-break: break-word;
      padding-top: 5px;
      padding-bottom: 5px;
    }

    .ag-theme-quartz-dark .ag-cell-value {
      line-height: 15px !important;
      word-break: break-word;
      padding-top: 5px;
      padding-bottom: 5px;
    }

    .cell-ellipsis {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: normal;
    }

    .scrollable-cell {
      height: 100%;
      overflow-y: auto; /* Enables vertical scrolling */
    }

    .scrollable-cell::-webkit-scrollbar {
      display: block;
    }

    .simplebar-scrollbar::before {
      background-color: rgba(0, 0, 0, 0.1);
    }

    .scrollable-cell:hover .simplebar-scrollbar::before {
      background-color: rgba(0, 0, 0, 0.75);
    }

    /* Flexbox layout for body */
    body {
      display: flex;
      flex-direction: column; /* Stack elements vertically */
      height: 100vh; /* Full viewport height */
      margin: 0; /* Remove default margin */
      font-family: 'Inter Tight', sans-serif;
    }

    /* Container for buttons */
    .button-container {
      flex-shrink: 0; /* Prevent shrinking */
      margin: 10px 0;
      overflow-x: auto; /* Enable horizontal scrolling for buttons */
    }

    /* Adjusted grid container */
    #myGrid {
      flex-grow: 1; /* Allow the grid to take up remaining space */
      width: 100%; /* Full width */
      /* Removed fixed height to allow flexbox to control the size */
    }

    .ag-theme-quartz {
      /* --ag-grid-size: 3px;  */
      /* --ag-header-height: 80px; */
    }

    .blog-btn {
      background-color: #dfd2fd; /* Light purple background */
      /* border: 3px solid black;  */
      color: black; /* Text color */
      font-weight: bold;
    }
    .blog-btn:hover {
      background-color: #cdbafd; /* Slightly darker on hover */
    }

    .pey-btn {
      background-color: #4663aa; /* Light purple background */
      /* border: 3px solid black;  */
      color: white; /* Text color */
      font-weight: bold;
    }
    .pey-btn:hover {
      color: white; /* Text color */
      background-color: #3c5491; /* Slightly darker on hover */
    }

    .btn-sm {
      padding: 0.25rem 0.5rem;
      font-size: 0.75rem;
      line-height: 1.5;
      border-radius: 0.2rem;
    }

    .right-buttons {
      margin-right: 4px;
    }

    .btn-sm {
      margin-top: 2px; /* Adjust the value as needed */
      margin-bottom: 2px; /* Adjust the value as needed */
    }

    .ag-tooltip{
      max-width: 300px;
    }

  </style>
  <style>
    .company-cell, .linkedin-cell {
        display: flex;
        flex-direction: column;
        align-items: left;
    }
    .company-cell img {
        background-color: white;
        margin-top: 15px;
        width: 20vw; /* 10% of the viewport width */
        height: auto; /* Maintain aspect ratio */
        max-width:  80px; /* Maximum width */
        max-height: 80px; /* Maximum height */
    }
    .linkedin-cell img {
        margin-top: 5px;
        width: 6vw; /* 10% of the viewport width */
        height: auto; /* Maintain aspect ratio */
        max-width:  25px; /* Maximum width */
        max-height: 25px; /* Maximum height */
    }
  </style>
  <noscript>
    <style>
      /**
      * Reinstate scrolling for non-JS clients
      */
      .simplebar-content-wrapper {
        scrollbar-width: auto;
        -ms-overflow-style: auto;
      }

      .simplebar-content-wrapper::-webkit-scrollbar,
      .simplebar-hide-scrollbar::-webkit-scrollbar {
        display: initial;
        width: initial;
        height: initial;
      }
    </style>
  </noscript>
  <link rel="icon" href="assets/img/favicons/favicon.ico" type="image/x-icon">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q095PB1G6R"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-Q095PB1G6R');
  </script>
 </head>
  <body>
    <div id="buttonContainer" style="padding: 4px" class="d-flex justify-content-between align-items-center flex-wrap">
      <div class="d-flex justify-content-between align-items-center flex-wrap" style="padding: 4px;">
        <h5 id='workStudyTitle' class="mb-0"><b>UofT PEY Co-op Jobs</b> (2024-2025 Fall/Winter)</h5>
        <div class="d-flex justify-content-end">
          <span style="margin: 0 5px;"> </span>
          <button class="btn blog-btn btn-sm right-buttons" onclick="window.open('/', '_blank')">
            <i class="fa-solid fa-circle" style="color: #6e46e7;"></i> Sadman's Blog
          </button>
          <button id="dataButton" class="btn btn-dark btn-sm right-buttons" onclick="window.open('posts/analyzing-pey-postings-part-1/', '_blank')">
            <i class="fa-solid fa-circle-question"></i> <i>How was this data sourced?</i>
          </button>
          <button id="githubButton" class="btn btn-dark btn-sm right-buttons" onclick="window.open('https://github.com/sadmanca/uoft-pey-coop-job-postings', '_blank')">
            <i class="fa-brands fa-github"></i>
          </button>
          <button class="btn btn-primary btn-sm right-buttons" onclick="window.open('https://linkedin.com/in/sadmanca', '_blank')">
            <i class="fa-brands fa-linkedin"></i>
          </button>
        </div>
      </div>

      <div id="buttonContainer" style="padding: 4px" class="d-flex justify-content-between align-items-center flex-wrap">
        <div>
          <button class="btn pey-btn btn-sm btn-spacing" onclick="window.open('https://discover.engineering.utoronto.ca/experiential-learning/professional-experience-year-pey/', '_blank')">
            <i class="fa-solid fa-circle-question"></i> What is PEY Co-op?
          </button>
          <span style="margin: 0 2px;">|</span>
          <button id="groupByCompanyButton" class="btn btn-warning btn-sm" onclick="groupByCompany()">
            <i class="fas fa-layer-group"></i> Group by Company
          </button>
          <span style="margin: 0 2px;">|</span>
          <!-- <button class="btn btn-outline-success btn-sm" disabled onclick="exportSelectedRowsToExcel()">
            <i class="fas fa-file-excel"></i> Export Selected Rows to Excel
          </button> -->
          <button id="exportCsvButton" class="btn btn-outline-primary btn-sm" disabled onclick="exportSelectedRowsToCSV()">
            <i class="fas fa-file-csv"></i> Export Selected Rows to CSV
          </button>
          <button id="exportExcelButton" class="btn btn-outline-success btn-sm" disabled onclick="exportSelectedRowsToExcel()">
            <i class="fas fa-file-excel"></i> Export Selected Rows to Excel
          </button>
          <span style="margin: 0 2px;">|</span>
          <button class="btn btn-primary btn-sm" onclick="exportAllRowsToCSV()">
            <i class="fas fa-file-csv"></i> Download CSV
          </button>
          <button class="btn btn-success btn-sm" onclick="exportAllRowsToExcel()">
            <i class="fas fa-file-excel"></i> Download Excel
          </button>
          <button id="toggleExpiredJobsButton" class="btn btn-sm" style="background-color: #520000; border-color: #520000; color: #fff;">
            <i class="fas fa-xmark"></i> Hide Expired Jobs
          </button>
          <button id="toggleExpiringJobsButton" class="btn btn-sm" style="background-color: #525200; border-color: #525200; color: #fff;">
            <i class="fas fa-clock"></i> Show Jobs Expiring Soon
          </button>
          <span style="margin: 0 2px;">|</span>
          <button id="toggleThemeButton" class="btn btn-outline-dark btn-sm" onclick="toggleTheme()">
            <i class="fas fa-moon"></i> Dark Mode
          </button>
        </div>
      </div>
    </div>
    <div id="myGrid" style="width: 100%; height: 100%"></div>
  </body>
</html>

<script>
  document.addEventListener('DOMContentLoaded', function() {
      const gridDiv = document.getElementById('myGrid');
      const buttonContainer = document.getElementById('buttonContainer');
      const toggleButton = document.getElementById('toggleThemeButton');
      const dataButton = document.getElementById('dataButton');
      const githubButton = document.getElementById('githubButton');
      const workStudyTitle = document.getElementById('workStudyTitle');
      const savedTheme = localStorage.getItem('theme');
      const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const override = false;

      // Listen for messages from the parent document
      window.addEventListener('message', function(event) {
        if (event.data && typeof event.data.isDarkMode !== 'undefined') {
          prefersDarkScheme = event.data.isDarkMode;
          override = true;
          // You can now use isDarkMode in your script
        }
      });

      if (savedTheme) {
          applyTheme(savedTheme);
      } else if (prefersDarkScheme) {
          applyTheme('dark');
      } else {
          applyTheme('light');
      }

      toggleButton.addEventListener('click', toggleTheme);

      function applyTheme(theme) {
          if (theme === 'dark') {
              gridDiv.classList.remove('ag-theme-quartz');
              gridDiv.classList.add('ag-theme-quartz-dark');
              buttonContainer.style.backgroundColor = '#1c232e';
              document.body.style.backgroundColor = '#1c232e';
              toggleButton.classList.remove('btn-outline-dark');
              toggleButton.classList.add('btn-outline-light');
              githubButton.classList.remove('btn-dark');
              githubButton.classList.add('btn-light');
              dataButton.classList.remove('btn-dark');
              dataButton.classList.add('btn-light');
              workStudyTitle.style.color = '#ffffff';
              toggleButton.innerHTML = '<i class="fas fa-circle"></i> Light Mode';
          } else {
              gridDiv.classList.remove('ag-theme-quartz-dark');
              gridDiv.classList.add('ag-theme-quartz');
              buttonContainer.style.backgroundColor = '#fff';
              document.body.style.backgroundColor = '#fff';
              toggleButton.classList.remove('btn-outline-light');
              toggleButton.classList.add('btn-outline-dark');
              githubButton.classList.remove('btn-light');
              githubButton.classList.add('btn-dark');
              dataButton.classList.remove('btn-light');
              dataButton.classList.add('btn-dark');
              workStudyTitle.style.color = '#000000';
              toggleButton.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
          }
          localStorage.setItem('theme', theme);
      }

      function toggleTheme() {
          const currentTheme = gridDiv.classList.contains('ag-theme-quartz') ? 'light' : 'dark';
          const newTheme = currentTheme === 'light' ? 'dark' : 'light';
          applyTheme(newTheme);
          gridApi.redrawRows();
      }
  });
</script>

<script>
  function getCurrentTheme() {
    const gridDiv = document.querySelector('#myGrid');
    return gridDiv.classList.contains('ag-theme-quartz') ? 'light' : 'dark';
  }

  function scrollableHTMLCellRenderer(params) {
    const formattedValue = params.value ? params.value : '';
    return `<div class="scrollable-cell" data-simplebar data-simplebar-auto-hide="false">${formattedValue}</div>`;
  }

  function scrollableCellRenderer(params) {
    // Check if params.value exists and replace newline characters with HTML line breaks
    const formattedValue1 = params.value ? params.value.replace(/\n/g, '<br><br>') : '';
    const formattedValue = formattedValue1.replace(/<br><br><br>/g, '<br><br>');
    return `<div class="scrollable-cell" data-simplebar data-simplebar-auto-hide="false">${formattedValue}</div>`;
  }

  function CompanyWebsiteRenderer(params) {
    // Ensure params.value is defined and is a string
    if (typeof params.value !== 'string') return '';

    // Extract the first URL from the text
    const urlMatch = params.value.match(/https?:\/\/[^ \n]+/);
    if (!urlMatch) return params.value; // Return original text if no URL found

    let firstUrl = urlMatch[0];
    // Replace any "/)" with "/"
    firstUrl = firstUrl.replace('/)', '/');

    const link = `<a href="${firstUrl}" target="_blank">${new URL(firstUrl).hostname}</a>`;
    return link;
  }

  function updateExportButtonsState() {
    const noRowsSelected = gridApi && gridApi.getSelectedRows().length === 0;
    document.getElementById('exportCsvButton').disabled = noRowsSelected;
    document.getElementById('exportExcelButton').disabled = noRowsSelected;
  }

  function MultiLineTextCellEditor() {}

  MultiLineTextCellEditor.prototype.init = function(params) {
    this.params = params;
    this.eGui = document.createElement('textarea');
    this.eGui.style.width = '100%';
    this.eGui.style.height = '100%';
    this.eGui.value = params.value;
  };

  MultiLineTextCellEditor.prototype.getGui = function() {
    return this.eGui;
  };

  MultiLineTextCellEditor.prototype.afterGuiAttached = function() {
    this.eGui.focus();
    this.eGui.select();
  };

  MultiLineTextCellEditor.prototype.getValue = function() {
    return this.eGui.value;
  };

  MultiLineTextCellEditor.prototype.destroy = function() {};

  const companyImages = {
    "AMD (Advanced Micro Devices, Inc.)": "https://www.amd.com",
    "Nvidia": "https://www.nvidia.com",
    "ACS Powersports": "https://www.acspowersports.ca",
    "AES Engineering": "https://www.aesengr.com",
    "Acciona Infrastructure Canada Inc.": "https://www.acciona.ca",
    "Air Canada": "https://www.aircanada.com",
    "Alberici Constructors": "https://www.alberici.com",
    "AlphaWave SEMI": "https://www.awavesemi.com",
    "AltaLink LP": "https://www.altalink.ca",
    "Altera, An Intel Company": "https://www.intel.com",
    "Analog Devices Inc.": "https://www.analog.com",
    "Arcadis IBI Group": "https://www.ibigroup.com",
    "Arla Foods Inc.": "https://www.arlafoods.ca",
    "Aviva Canada Inc": "https://www.aviva.ca",
    "BA Consulting Group Ltd.": "https://www.bagroup.com",
    "Bank of America Merrill Lynch": "https://www.ml.com",
    "Baylis Medical Technologies": "https://www.baylismedtech.com",
    "Bibliocommons Inc.": "https://www.bibliocommons.com",
    "Birch Hill Equity Partners": "https://www.birchhillequity.com",
    "Brigham & Women's Hospital, Harvard Medical School": "https://www.brighamandwomens.org",
    "Briza": "https://www.briza.com",
    "Cadence Design Systems Inc": "https://www.cadence.com",
    "Cadillac Fairview": "https://www.cadillacfairview.com",
    "Canadensys Aerospace": "https://www.canadensys.com",
    "Canadian Natural Resources Limited": "https://www.cnrl.com",
    "Castleton Commodities International": "https://www.cci.com/",
    "Cenovus Energy, Inc.": "https://www.cenovus.com/",
    "CentML Inc": "https://www.centml.ai/",
    "Cerebras Systems": "https://www.cerebras.ai/",
    "Change Connect Inc.": "https://www.changeconnect.ca/",
    "DHL Supply Chain": "https://www.dhl.com",
    "Defence R&D Canada (DRDC) - Ottawa": "https://www.canada.ca",
    "E11 Bio": "https://www.e11.bio/",
    "Ecobee": "https://www.ecobee.com",
    "Edgewood Health Network Inc": "https://www.edgewoodhealthnetwork.com/",
    "Elevate Construction Management": "https://www.elevatecm.com/",
    "Enerlife Consulting Inc.": "https://www.enerlife.com/",
    "Environment and Climate Change Canada": "https://www.canada.ca",
    "Epson": "https://www.epson.ca",
    "Evertz Microsystems Ltd": "https://www.evertz.com",
    "Geomechanica Inc.": "https://www.geomechanica.com/",
    "Geotab": "https://www.geotab.com/",
    "Groq Inc.": "https://www.groq.com/",
    "HDR Corporation": "https://www.hdrinc.com",
    "HF Sinclair": "https://www.hfsinclair.com",
    "HOOPP Healthcare of Ontario Pension Plan": "https://www.hoopp.com/",
    "HTS Engineering": "https://www.hts.com/",
    "Harmonic Fund Services": "https://www.harmonicfundservices.com/",
    "Honda Canada Inc.": "https://www.honda.ca",
    "Huawei Technologies Canada Co. Ltd.": "https://www.huawei.com",
    "Husky Injection Molding Systems Ltd.": "https://www.husky.co/",
    "Hydro One Limited": "https://www.hydroone.com/",
    "Intact Financial Corporation": "https://www.intact.ca/",
    "Invictus Analytics and Strategy Inc.": "https://www.invictusas.com/",
    "JMA Consulting": "https://www.jmaconsulting.biz",
    "Kijiji": "https://www.kijiji.ca",
    "Kinaxis": "https://www.kinaxis.com",
    "Kinectrics Inc.": "https://www.kinectrics.com/",
    "Kortex Enterprises LLC": "https://www.kortex.co/",
    "Labworks International Inc.": "https://www.labworksinternational.com/",
    "Ledcor": "https://www.ledcor.com",
    "Left Turn Right Turn (LTRT)": "https://www.ltrt.ca",
    "MHI RJ Aviation Group": "https://www.mhirj.com/",
    "Marvell Technology Group (US)": "https://www.marvell.com",
    "Massachusetts Institute of Technology (MIT)": "https://www.mit.edu",
    "Mattamy Homes Limited": "https://www.mattamyhomes.com/",
    "MedMe Health": "https://www.medmehealth.com/",
    "Memme Infrastructure Contractors": "https://www.memme.com/",
    "Metrolinx": "https://www.metrolinx.com",
    "Microchip Technology Inc.": "https://www.microchip.com/",
    "Monday Girl": "https://www.joinmondaygirl.com/",
    "Moody's Analytics": "https://www.moodys.com/",
    "Movellus": "https://www.movellus.com/",
    "Nest Wealth Solutions Inc.": "https://www.nestwealth.com/",
    "New School Foods Inc.": "https://www.newschoolfoods.co/",
    "OMERS": "https://www.omers.com/",
    "Ontario Ministry of Transportation": "https://www.ontario.ca",
    "Ontario Teachers Pension Plan": "https://www.otpp.com",
    "Pason Systems Corp.": "https://www.pason.com/",
    "Periscope Capital Inc": "https://www.periscopecap.com/",
    "Picovoice": "https://www.picovoice.ai/",
    "PolicyMe": "https://www.policyme.com",
    "Pomerleau, Inc": "https://www.pomerleau.ca",
    "Posterity Group": "https://www.posteritygroup.ca/",
    "Power Advisory": "https://www.poweradvisoryllc.com/",
    "Procter & Gamble Inc.": "https://www.pg.com",
    "Purpose Building Inc.": "https://www.purposebuilding.ca/",
    "Quanta Technology": "https://www.quanta-technology.com/",
    "Quantim Intelligence": "https://www.qic.ai/",
    "Read Jones Christoffersen (RJC Engineers)": "https://www.rjc.ca/",
    "Regional Municipality of York": "york.ca",
    "RocMar Engineering Inc.": "https://rocmar.ca/",
    "Royal Bank of Canada (RBC)": "https://www.rbcroyalbank.com/",
    "Royal Canadian Mounted Police": "https://www.rcmp-grc.gc.ca/",
    "SAFRAN Landing Systems (Messier-Dowty Inc.)": "https://www.safran-group.com",
    "Safety Power Inc": "https://www.safetypower.ca/",
    "Scotiabank": "https://www.scotiabank.com",
    "Select Equity Group, L.P.": "https://www.selectequity.com/",
    "Semtech": "https://www.semtech.com/",
    "Smith + Andersen": "https://smithandandersen.com/",
    "Snowflake, Inc.": "https://www.snowflake.com",
    "StoneX Group Inc.": "https://www.stonex.com/en/",
    "Structura Biotechnology Inc.": "https://structura.bio/",
    "Sun Life Financial": "https://www.sunlife.ca",
    "Synopsys, Inc.": "https://www.synopsys.com/",
    "TC Energy Corp.": "https://www.tcenergy.com/",
    "TD Securities": "https://www.tdsecurities.com/",
    "Taalas Inc.": "https://taalas.com/",
    "Technical University of Munich (TUM)": "https://www.tum.de/",
    "Tenstorrent Inc": "https://tenstorrent.com/",
    "Tesla": "https://www.tesla.com/",
    "Tetra Trust": "https://tetratrust.com/",
    "The Independent Electricity System Operator (IESO)": "https://www.ieso.ca/",
    "The Mosaic Company": "https://mosaicco.com/",
    "The Six Semiconductor": "https://www.thesixsemi.com/",
    "Town of Oakville": "https://www.oakville.ca/",
    "Uken Games": "https://uken.com/",
    "University Health Network": "https://www.uhn.ca/",
    "University of Toronto - Facilities & Services": "https://www.fs.utoronto.ca/",
    "Untether AI": "https://www.untether.ai/",
    "Vale Canada": "https://www.vale.com",
    "Veeva Systems": "https://www.veeva.com/",
    "Vena Solutions": "https://www.venasolutions.com/",
    "Xpan Inc.": "https://xpanmedical.com/",
    "YuJa Canada Inc.": "https://www.yuja.com/",
    "ZS Associates": "https://www.zs.com/",
    "Zynga Inc.": "https://www.zynga.com/",
    "ePIC Blockchain Technologies": "https://www.epicblockchain.io/",
    "t0.technology": "https://www.t0.technology/"
  };

  const gridOptions = {
    columnDefs: [
      {
        headerCheckboxSelection: true, // Enable checkbox on the header
        checkboxSelection: true, // Enable row checkboxes
        field: "jobPostingDate",
        headerName: "Posting Date",
        width: 175,
        rowGroup: false,
        hide: false,
        pinned: 'left',
        filter: "agDateColumnFilter",
        // filterParams: {
        //   comparator: filterDateComparator
        // },
        sortable: true,
        sort: 'desc',
        // comparator: dateComparator,
        cellEditor: MultiLineTextCellEditor,
        tooltipValueGetter: function(params) {
          return `Date when job was posted on the PEY portal`;
        },
      },
      {
        field: "jobTitle",
        width: 120,
        pinned: 'left',
      },
      {
        field: "companyName",
        hide: false,
        width: 117,
        pinned: 'left',
        cellRenderer: function(params) {
            const companyName = params.value;
            const companyUrl = companyImages[companyName];
            if (!companyUrl) {
                return companyName;
            }
            const sanitizedUrl = companyUrl.replace(/^https:\/\/www\./, '').replace(/\/$/, '');
            var imageUrl = "https://logo.clearbit.com/" + sanitizedUrl;
            if (companyName == "Cerebras Systems") {
              imageUrl = "https://cerebras.ai/wp-content/uploads/2022/05/Cerebras-logo-standard.jpg";
            } else if (companyName == "Kortex Enterprises LLC") {
              imageUrl = "https://assets-v2.circle.so/ph8d48idvikb2hzy6sec54as8phk";
            } else if (companyName == "Safety Power Inc") {
              imageUrl = "https://www.safetypower.ca/static/img/logo.jpg";
            } else if (companyName == "StoneX Group Inc.") {
              imageUrl = "https://www.stonex.com/en/-/media/project/gain-capital/stonex/stonex-main/logos/stonex-logo-black.svg?iar=0&extension=webp&hash=CB5E65DCC6F52A6D4CC15E709B73C6C3";
            } else if (companyName == "Royal Canadian Mounted Police") {
              imageUrl = "https://logo.clearbit.com/canada.ca";
            }
            if (imageUrl) {
                return `<div class="company-cell">
                            <a href="${companyUrl}" target="_blank">${companyName}</a>
                            <img src="${imageUrl}" alt="${companyName}">
                        </div>`;
            }
            return companyName;
        }
      },
      {
        field: "jobDescription",
        width: 350,
        wrapText: true,
        // cellClass: 'cell-wrap-text',
        // autoHeight: true,
        cellRenderer: scrollableHTMLCellRenderer,
        filter: 'agTextColumnFilter',
      },
      {
        field: "requiredQualifications",
        width: 150,
        wrapText: true,
        // cellClass: 'cell-wrap-text',
        // autoHeight: true,
        cellRenderer: scrollableCellRenderer,
        filter: 'agTextColumnFilter',
      },
      {
        field: "preferredProgramClusters",
        headerName: "Preferred Majors",
        width: 140,
        // wrapText: false,
        cellRenderer: scrollableCellRenderer,
        filter: 'agTextColumnFilter',
      },
      // {
      //   field: "companyWebsite",
      //   cellRenderer: CompanyWebsiteRenderer,
      //   width: 117,
      // },
      {
        field: "compensation",
        headerName: "Pay",
        width: 100,
      },
      {
        field: "remoteOnSite",
        headerName: "Location Type",
        width: 113,
        cellRenderer: scrollableCellRenderer,
      },
      {
        field: "jobLocation",
        width: 115,
        // cellRenderer: function(params) {
        //   const jobLocation = params.value;
        //   if (jobLocation.includes('\n')) {
        //     const locations = jobLocation.split('\n');
        //     return '<ul style="margin: 0; padding-left: 15px;">' + locations.map(location => '<li>' + location + '</li>').join('') + '</ul>';
        //   }
        //   return jobLocation;
        // }
      },
      {
      field: "companyLocation",
      width: 120,
      cellRenderer: function(params) {
          const location = params.value;
          if (!location) {
              return ''; // Return an empty string if the location is blank
          }
          const googleMapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location)}`;
          return `<div class="linkedin-cell">
                      <a href="${googleMapsUrl}" target="_blank">${location}</a>
                      <img src="https://lh3.googleusercontent.com/V0Lu6YzAVaCVcjSJ_4Qb0mR_idw-GApETGbkodvDKTH-rpDvHuD6J84jshR_FvXdl5mJxqbIHVdebYCCbQMJNxIxRaIHYFSq6z7laA" alt="Google Maps">
                  </div>`;
        }
      },
      // {
      //   field: "startDate",
      //   width: 110,
      //   filterParams: {
      //     filters: [
      //       { filter: "agDateColumnFilter", },
      //       { filter: "agSetColumnFilter", },
      //     ],
      //   },
      // },
      // {
      //   field: "endDate",
      //   width: 110,
      //   filterParams: {
      //     filters: [
      //       { filter: "agDateColumnFilter", },
      //       { filter: "agSetColumnFilter", },
      //     ],
      //   },
      // },
    {
      field: "workTerm",
      width: 120,
      // cellStyle: function(params) {
      //   const workTerm = params.value;
      //   if (!workTerm) {
      //     return ''; // Return an empty string if the location is blank
      //   }
      //   let backgroundColor = '';
      //   const currentTheme = getCurrentTheme();
      //   if (workTerm.includes('Summer')) {
      //       backgroundColor = currentTheme === 'dark' ? '#1d361d' : '#e6f7e6'; // Dark green for dark mode, light green for light mode
      //   } else if (workTerm.includes('Fall')) {
      //       backgroundColor = currentTheme === 'dark' ? '#381e38' : '#ffe8ff'; // Dark red for dark mode, light red for light mode
      //   } else if (workTerm.includes('Winter')) {
      //       backgroundColor = currentTheme === 'dark' ? '#29394d' : '#e8f2ff'; // Dark red for dark mode, light red for light mode
      //   }
      //   return { backgroundColor: backgroundColor, color: currentTheme === 'dark' ? 'white' : 'black' };
      // }
    },
    {
      field: "applicationDeadline",
      width: 170,
      filter: 'agDateColumnFilter',
      filterParams: {
          comparator: appDeadlineFilterDateComparator
        },
      sortable: true,
      comparator: appDeadlineSortDateComparator,
      cellStyle: params => {
          const today = new Date();
          const deadline = new Date(params.value);

          if (deadline) {
              const timeDiff = deadline - today;
              const dayDiff = timeDiff / (1000 * 60 * 60 * 24);

              if (dayDiff < 0) {
                  return { backgroundColor: '#2e0000', color: 'white' };
              } else if (dayDiff <= 7) {
                  return { backgroundColor: '#3b3b01', color: 'white' };
              }
          }
          return null;
      },
    },
    // {
    //   field: "applicationMethod",
    // },
    // {
    //   field: "applicationReceiptProcedure",
    //   headerName: "Application Procedure",
    //   width: 130,
    //   cellRenderer: scrollableCellRenderer,
    //   filter: 'agTextColumnFilter',
    // },
    // {
    //   field: "applicationDetails",
    //   width: 130,
    //   cellRenderer: scrollableCellRenderer,
    //   filter: 'agTextColumnFilter',
    //   hide: true,
    // },
    {
      field: "jobId",
      headerName: "Job ID",
      width: 100,
      hide: false,
      filterParams: {
        filters: [
          { filter: "agNumberColumnFilter" },
          { filter: "agSetColumnFilter" },
        ],
      },
    },
    {
    field: "contact",
    width: 120,
    cellRenderer: function(params) {
        const contact = params.value;
        const companyName = params.data.companyName;
        if (contact) {
            const searchQuery = encodeURIComponent(`${contact} ${companyName}`);
            const linkedInUrl = `https://www.linkedin.com/search/results/people/?keywords=${searchQuery}`;
            return `<div class="linkedin-cell">
                        <a href="${linkedInUrl}" target="_blank">${contact}</a>
                        <img src="https://content.linkedin.com/content/dam/me/business/en-us/amp/brand-site/v2/bg/LI-Bug.svg.original.svg" alt="LinkedIn">
                    </div>`;
        }
        return contact;
      }
    },
    {
      field: "numberOfOpenings",
      headerName: "Num. Openings",
      width: 118,
      filterParams: {
        filters: [
          { filter: "agNumberColumnFilter" },
          { filter: "agSetColumnFilter" },
        ],
      },
      // Use a value formatter to check the value before displaying
      // valueFormatter: function(params) {
      //   // Check if the value is a valid number
      //   const isValidNumber = !isNaN(params.value) && isFinite(params.value);
      //   // Return the value if it's a valid number, otherwise return an empty string
      //   return isValidNumber ? params.value : '';
      // },
    },
    {
      field: "workTermDuration",
      width: 125,
    },
    {
      field: "workTermDurationOther",
      width: 120,
    },
    // {
    //   field: "positionType",
    //   width: 120,
    // },
    ],

    defaultColDef: {
      enableRowGroup: true,
      wrapHeaderText: true, // Allow header text to wrap
      autoHeaderHeight: true, // Automatically adjust header height
      resizable: true,
      sortable: true,
      initialWidth: 170,
      editable: true,
      filter: true,
      wrapText: true,
      cellEditor: MultiLineTextCellEditor,
      wrapHeaderText: true,
      autoHeaderHeight: true,
      floatingFilter: true,
      filter: "agMultiColumnFilter",
      filterParams: {
        filters: [
          { filter: "agTextColumnFilter", },
          { filter: "agSetColumnFilter", },
        ],
      },
      },

    groupUseEntireRow: true,

    getRowStyle: function(params) {
    if (params.node.group) {
        return null; // Do not apply any style to group rows
    }

    const today = new Date();
    const deadline = params.data ? new Date(params.data.applicationDeadline) : null;

    if (deadline) {
        const timeDiff = deadline - today;
        const dayDiff = timeDiff / (1000 * 60 * 60 * 24);

        const theme = getCurrentTheme();
        const isDarkTheme = theme === 'dark';

        if (dayDiff < 0) {
            return {
                backgroundColor: isDarkTheme ? '#260000' : '#faeae8',
                color: isDarkTheme ? 'white' : 'black'
            };
        } else if (dayDiff <= 7) {
            return {
                backgroundColor: isDarkTheme ? '#212100' : '#fffce6',
                color: isDarkTheme ? 'white' : 'black'
            };
        }
    }

    return null;
},

    // rowHeight: 250,
    getRowHeight: function(params) {
      // Check if the row is a group row
      if (params.node.group) {
        // Return the desired height for group rows
        return 30; // Example: Set group row height to 100px
      }
      // Return a different height for non-group rows or default height
      return 250; // Example: Set non-group row height to 25px
    },

    rowSelection: 'multiple',
    onSelectionChanged: updateExportButtonsState,
    rowMultiSelectWithClick: true, // Allow multiple rows to be selected with clicks

    groupDefaultExpanded: -1,
    groupDisplayType: 'groupRows',
    rowGroupPanelShow: 'always',

    tooltipShowDelay: 500,
    tooltipHideDelay: 1200,
    tooltipMouseTrack: true,

    statusBar: {
      statusPanels: [
       {
          statusPanel: "agTotalAndFilteredRowCountComponent",
          align: "left",
        },
       {
          statusPanel: "agSelectedRowCountComponent",
          align: "left",
        },
      ],
    },
    enableRangeSelection: true,
    // Function to determine if a row should be selectable
    isRowSelectable: function(rowNode) {
      // Return false if the row is a group row, making it not selectable
      return !rowNode.group;
    },

    pivotMode: false,
    sideBar: {
      toolPanels: [
        {
          id: "columns",
          labelDefault: "Columns",
          labelKey: "columns",
          iconKey: "columns",
          toolPanel: "agColumnsToolPanel",
          width: 250,
          toolPanelParams: {
            suppressValues: true, // This will hide the aggregation options
            suppressPivotMode: true, // This will hide the pivot mode options
          },
        },
        {
          id: "filters",
          labelDefault: "Filters",
          labelKey: "filters",
          iconKey: "filter",
          toolPanel: "agFiltersToolPanel",
          width: 200,
        },
      ],
      defaultToolPanel: "columns",
    },

    onGridReady: (params) => {
      var defaultSortModel = [
        { colId: "jobPostingDate", sort: "desc", sortIndex: 0 },
        { colId: "applicationDeadline", sort: "asc", sortIndex: 1 },
      ];

      params.api.applyColumnState({ state: defaultSortModel });
    },

    pagination: false,
    // paginationPageSize: 1,
    // paginationPageSizeSelector: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],

    // isExternalFilterPresent: isExternalFilterPresent,
    // doesExternalFilterPass: doesExternalFilterPass,

  };

  function generateReadableTimestamp() {
    const date = new Date();
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    const hours = String(date.getHours()).padStart(2, '0');
    const minutes = String(date.getMinutes()).padStart(2, '0');
    const seconds = String(date.getSeconds()).padStart(2, '0');
    return `${year}_${month}_${day}-${hours}_${minutes}_${seconds}`;
  }

  // Function to generate the filename with a readable timestamp
  function generateFilename(baseName, extension) {
    const timestamp = generateReadableTimestamp();
    return `${baseName}-${timestamp}.${extension}`;
  }

  function exportSelectedRowsToCSV() {
    if (gridApi) {
      const filename = generateFilename('SELECTED-uoft-work-study-jobs', 'csv');
      gridApi.exportDataAsCsv({
        onlySelected: true,
        fileName: filename
      });
    } else {
      console.error('Grid API is not available.');
    }
  }

  function exportSelectedRowsToExcel() {
    if (gridApi) {
      const filename = generateFilename('SELECTED-uoft-work-study-jobs', 'xlsx');
      gridApi.exportDataAsExcel({
        onlySelected: true,
        fileName: filename
      });
    } else {
      console.error('Grid API is not available.');
    }
  }

  function exportAllRowsToCSV() {
    const filename = generateFilename('ALL-uoft-work-study-jobs', 'csv');
    if (gridApi) {
      gridApi.exportDataAsCsv({
        onlySelected: false,
        fileName: filename
      });
    } else {
      console.error('Grid API is not available.');
    }
  }

  function exportAllRowsToExcel() {
    const filename = generateFilename('ALL-uoft-work-study-jobs', 'xlsx');
    if (gridApi) {
      gridApi.exportDataAsExcel({
        onlySelected: false,
        fileName: filename
      });
    } else {
      console.error('Grid API is not available.');
    }
  }

  // Function to check window width and toggle side panel
  function checkWindowWidth() {
    if (window.innerWidth < 1600) {
      gridApi.closeToolPanel();
    } else {
      gridApi.openToolPanel('columns');
    }

    if (window.innerWidth < 1000) {
      // Unpin all columns using gridApi
      const allColumns = gridApi.getColumnDefs();
      allColumns.forEach(col => {
        gridApi.setColumnPinned(col.field, null);
      });
    }
  }

  let hideExpired = false; // Track the current state for hiding expired jobs
  let showExpiring = false; // Track the current state for showing expiring jobs

  function toggleExpiredJobs() {
      // Reset the state of the other button
      if (showExpiring) {
          showExpiring = false;
          const expiringButton = document.querySelector('#toggleExpiringJobsButton');
          expiringButton.innerHTML = '<i class="fas fa-clock"></i> Show Jobs Expiring Soon';
      }

      hideExpired = !hideExpired; // Toggle the state

      const today = new Date();
      today.setHours(0, 0, 0, 0); // Set to midnight to compare only the date part

      gridApi.getFilterInstance('applicationDeadline', function(filterInstance) {
          if (hideExpired) {
              // Set the filter to hide expired jobs
              filterInstance.setModel({
                  type: 'greaterThan',
                  dateFrom: today.toISOString().split('T')[0] // Format date as YYYY-MM-DD
              });
          } else {
              // Clear the filter to show all jobs
              filterInstance.setModel(null);
          }
          gridApi.onFilterChanged();
      });

      // Update button text
      const button = document.querySelector('#toggleExpiredJobsButton');
      button.innerHTML = hideExpired ? '<i class="fas fa-bars"></i> Show Expired Jobs' : '<i class="fas fa-xmark"></i> Hide Expired Jobs';
  }

  function toggleExpiringJobs() {
      // Reset the state of the other button
      if (hideExpired) {
          hideExpired = false;
          const expiredButton = document.querySelector('#toggleExpiredJobsButton');
          expiredButton.innerHTML = '<i class="fas fa-xmark"></i> Hide Expired Jobs';
      }

      showExpiring = !showExpiring; // Toggle the state

      const today = new Date();
      today.setHours(0, 0, 0, 0); // Set to midnight to compare only the date part

      const sevenDaysFromToday = new Date(today);
      sevenDaysFromToday.setDate(today.getDate() + 7); // Add 7 days to today

      gridApi.getFilterInstance('applicationDeadline', function(filterInstance) {
          if (showExpiring) {
              // Set the filter to show expiring jobs only
              filterInstance.setModel({
                  type: 'inRange',
                  dateFrom: today.toISOString().split('T')[0], // Format date as YYYY-MM-DD
                  dateTo: sevenDaysFromToday.toISOString().split('T')[0] // Format date as YYYY-MM-DD
              });
          } else {
              // Clear the filter to show all jobs
              filterInstance.setModel(null);
          }
          gridApi.onFilterChanged();
      });

      // Update button text
      const button = document.querySelector('#toggleExpiringJobsButton');
      button.innerHTML = showExpiring ? '<i class="fas fa-bars"></i> Show All Jobs' : '<i class="fas fa-clock"></i> Show Jobs Expiring Soon';
  }

  // Function to compare dates for sorting
  function appDeadlineSortDateComparator(date1, date2) {
    // Check if date1 or date2 is undefined or empty
    if (!date1 || !date2) {
        return 0;
    }

    // Parse the dates to Date objects
    const parsedDate1 = new Date(date1);
    const parsedDate2 = new Date(date2);

    // Compare the dates
    if (parsedDate1 < parsedDate2) {
        return -1;
    } else if (parsedDate1 > parsedDate2) {
        return 1;
    } else {
        return 0;
    }
  }

// Function to compare dates for filtering
function appDeadlineFilterDateComparator(filterLocalDateAtMidnight, cellValue) {
  // Parse the cell value to a Date object
  const date = new Date(cellValue);

  // Compare the dates
  if (date < filterLocalDateAtMidnight) {
    return -1;
  } else if (date > filterLocalDateAtMidnight) {
    return 1;
  } else {
    return 0;
  }
}

function dateComparator(date1, date2) {
  if (!date1 || !date2) {
    return 0;
  }
  const parsedDate1 = new Date(date1);
  const parsedDate2 = new Date(date2);
  return parsedDate1 - parsedDate2;
}

function filterDateComparator(filterLocalDateAtMidnight, cellValue) {
  const date = new Date(cellValue);
  if (date < filterLocalDateAtMidnight) {
    return -1;
  } else if (date > filterLocalDateAtMidnight) {
    return 1;
  } else {
    return 0;
  }
}

  // External filter to hide rows with blank postingDate
  function isExternalFilterPresent() {
    return true; // External filter is always active
  }

  function doesExternalFilterPass(node) {
    return node.data.postingDate; // Pass only if postingDate is not blank
  }

  function groupByCompany() {
    const currentGroupColumns = gridApi.getRowGroupColumns().map(col => col.getColId());
    const isGroupedByCompany = currentGroupColumns.includes('companyName');

    function getSortModel() {
        const sortState = gridApi.getAllColumns().map(col => ({
            colId: col.getColId(),
            sort: col.getSort()
        })).filter(col => col.sort != null);
        return sortState.length > 0 ? sortState : [];
    }

    function setSortModel(sortModel) {
        gridApi.applyColumnState({
            state: sortModel,
            applyOrder: true
        });
    }

    if (isGroupedByCompany) {
        // Clear grouping and revert sort
        gridApi.setRowGroupColumns([]);
        // setSortModel([{ colId: 'companyName', sort: 'asc' }]);
        gridApi.setColumnVisible('companyName', true); // Ensure the column is visible after ungrouping
    } else {
        // Group by Company, show the Company column, and sort by Company in ascending order
        gridApi.setRowGroupColumns(['companyName']);
        gridApi.setColumnVisible('companyName', true); // Ensure the column is visible
        // setSortModel([{ colId: 'companyName', sort: 'asc' }]);
    }

    gridApi.refreshClientSideRowModel('group');
  }


  document.addEventListener("DOMContentLoaded", function () {
    var gridDiv = document.querySelector("#myGrid");
    gridApi = agGrid.createGrid(gridDiv, gridOptions);

    fetch("/data/PEYJobPosting2024.json")
      .then((response) => response.json())
      .then((data) => gridApi.setGridOption("rowData", data));

    checkWindowWidth();
    window.addEventListener('resize', checkWindowWidth);
    document.querySelector('#toggleExpiredJobsButton').addEventListener('click', toggleExpiredJobs);
    document.querySelector('#toggleExpiringJobsButton').addEventListener('click', toggleExpiringJobs);
  });

</script>

<!--
for mapping pages to dates:

// Example mapping of page numbers to dates
const pageNumberToDateMap = {
  1: '2023-01-01',
  2: '2023-01-02',
  // Add more mappings as needed
};
const lastDate = '2023-01-31'; // Example last date

const gridOptions = {
  // Other grid options...
  pagination: true,
  paginationPageSize: 1,
  paginationNumberFormatter: function(params) {
    const currentPageDate = pageNumberToDateMap[params.value] || 'Unknown Date';
    return `${currentPageDate} out of ${lastDate}`;
  },
  // Other options like columnDefs, rowData, etc.
};

<div class="ag-tooltip ag-tooltip-animate ag-ltr ag-popup-child ag-tooltip-hiding" role="dialog" aria-label="Tooltip" style="top: 279px; left: 1230px;">Full Stack Engineer, Business Systems at ecobee</div>
-->